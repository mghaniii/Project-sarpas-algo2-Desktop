/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package com.mycompany.project.kel.desktop.sarpas.view;

import com.mycompany.project.kel.desktop.sarpas.dao.PemeliharaanDAO;
import com.mycompany.project.kel.desktop.sarpas.model.Pemeliharaan;
import java.util.List;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author AXIOO
 */
public class RiwayatPerawatanPanel extends javax.swing.JPanel {
 private PemeliharaanDAO pemeliharaanDAO;
    private DefaultTableModel tableModel;
    /**
     * Creates new form RiwayatPerawatanPanel
     */
    public RiwayatPerawatanPanel() {
        initComponents();
         this.pemeliharaanDAO = new PemeliharaanDAO();
        this.tableModel = (DefaultTableModel) tblRiwayatPerawatan.getModel();
        
        setupComboBoxFilter();
        loadRiwayatData();
        setupListeners();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        tblRiwayatPerawatan = new javax.swing.JTable();
        txtCariRiwayat = new javax.swing.JTextField();
        comboFilterStatus = new javax.swing.JComboBox<>();
        btnFilter = new javax.swing.JButton();

        tblRiwayatPerawatan.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "ID Pemeliharaan", "Tanggal Jadwal", "Tanggal Selesai", "Nama Barang", "Kode Barang", "Nama Petugas", "Status", "Catatan Tambahan"
            }
        ));
        jScrollPane1.setViewportView(tblRiwayatPerawatan);

        comboFilterStatus.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        btnFilter.setIcon(new javax.swing.ImageIcon("C:\\Users\\AXIOO\\Documents\\NetBeansProjects\\Project-kel-6-desktop-sarpas\\src\\main\\java\\img\\img\\iconcari.png")); // NOI18N

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 620, Short.MAX_VALUE)
                .addContainerGap())
            .addGroup(layout.createSequentialGroup()
                .addGap(32, 32, 32)
                .addComponent(txtCariRiwayat, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(comboFilterStatus, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnFilter)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(38, 38, 38)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtCariRiwayat, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(comboFilterStatus, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btnFilter, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 275, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(45, Short.MAX_VALUE))
        );
    }// </editor-fold>//GEN-END:initComponents

      private void setupComboBoxFilter() {
        comboFilterStatus.removeAllItems();
        comboFilterStatus.addItem("Semua");
        comboFilterStatus.addItem("Terjadwal");
        comboFilterStatus.addItem("Sedang Dikerjakan");
        comboFilterStatus.addItem("Selesai");
    }
    
        private void loadRiwayatData() {
        // Ambil nilai dari komponen filter di UI
        String keyword = txtCariRiwayat.getText();
        String status = comboFilterStatus.getSelectedItem().toString();
        
        tableModel.setRowCount(0); // Kosongkan tabel sebelum diisi
        
        // Panggil metode DAO dengan parameter filter
        List<Pemeliharaan> daftarJadwal = pemeliharaanDAO.getFilteredPemeliharaan(keyword, status);
        
        // Isi tabel dengan 8 kolom data
        for (Pemeliharaan p : daftarJadwal) {
            tableModel.addRow(new Object[]{
                p.getIdPemeliharaan(),
                p.getTanggalJadwal(),
                p.getTanggalSelesai(),
                p.getNamaBarang(),
                p.getKodeBarang(),
                p.getNamaPetugas(),
                p.getStatus(),
                p.getCatatanTambahan()
            });
        }
    }
      
       private void setupListeners() {
        // Setiap kali tombol filter diklik, panggil metode loadRiwayatData()
        btnFilter.addActionListener(e -> loadRiwayatData());
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnFilter;
    private javax.swing.JComboBox<String> comboFilterStatus;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable tblRiwayatPerawatan;
    private javax.swing.JTextField txtCariRiwayat;
    // End of variables declaration//GEN-END:variables
}
